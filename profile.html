<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="profile.css" />
  <title>Profile</title>
</head>
<body>
  <div class="profile-wrapper">
    <div class="profile-card">
      <img class="background-blur" src="vangogh.png" alt="Fond artistique" />
      <img class="background-preview hidden" alt="Prévisualisation" />

      <div class="section-title badges-title">Badges</div>
      <div class="section-line badges-line"></div>

      <div class="badges-grid">
        <img src="badge/Van Gogh.png" alt="Van Gogh" />
        <img src="badge/Picasso.png" alt="Picasso" />
        <img src="badge/Kahlo.png" alt="Kahlo" />
        <img src="badge/Monnet.png" alt="Monnet" />
        <img src="badge/Vinci.png" alt="Vinci" />
        <img src="badge/Dali.png" alt="Dali" />
      </div>

      <div class="stat-box red">
        <img src="likee.png" alt="Likes" />
        <div>1500</div>
      </div>

      <div class="stat-box yellow">
        <img src="fav2E.png" alt="Favoris" />
        <div>1500</div>
      </div>

      <div class="section-title stats-title">Statistiques</div>
      <div class="section-line stats-line"></div>

      <div class="level">Niv. 1</div>
      <div class="username">Yanaab</div>

      <div class="progress-bar-bg"></div>
      <div class="progress-bar-fill"></div>
      <div class="xp-text">150/200</div>
    </div>

    <!-- ✅ Bouton et formulaire en dehors de .profile-card -->
    <div class="edit-profile-button">Éditer le profil</div>

    <div class="edit-profile-form hidden">
      <label for="nameInput">Nom :</label>
      <input type="text" id="nameInput" placeholder="Entrez votre nom" />

     <label for="photoInput" class="custom-file-upload">
  <img src="like.png" alt="Choisir une photo" />
</label>
<input type="file" id="photoInput" accept="image/*" />

      <button id="saveProfileBtn">Sauvegarder</button>
    </div>

    <img class="logo" src="Logo.png" alt="Logo" />
    <div class="page-title">Profile</div>
  </div>

  <div class="navbar">
    <a href="#" class="home-link"><div class="home-marker"></div><img class="icon home-icon" src="home.png" alt="Accueil" /></a>
    <a href="peinture.html"><img class="icon" src="peinture.png" alt="Peinture" /></a>
    <a href="#"><img class="icon" src="peintre.png" alt="Peintre" /></a>
    <a href="#"><img class="icon" src="museum.png" alt="Musée" /></a>
    <a href="collection.html"><img class="icon" src="fav.png" alt="Favoris" /></a>
    <a href="profile.html"><img class="icon" src="profile.png" alt="Profil" /></a>
  </div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const editBtn = document.querySelector(".edit-profile-button");
    const form = document.querySelector(".edit-profile-form");
    const nameInput = document.getElementById("nameInput");
    const photoInput = document.getElementById("photoInput");
    const saveBtn = document.getElementById("saveProfileBtn");
    const usernameDisplay = document.querySelector(".username");
    const backgroundBlur = document.querySelector(".background-blur");

    // ✅ Ajout de la preview
    let previewImg = document.querySelector(".background-preview");
    if (!previewImg) {
      previewImg = document.createElement("img");
      previewImg.className = "background-preview hidden";
      previewImg.alt = "Prévisualisation";
      backgroundBlur.parentElement.appendChild(previewImg);
    }

    // ✅ Charger les données sauvegardées
    const savedName = localStorage.getItem("profileName");
    const savedPhoto = localStorage.getItem("profilePhoto");
    if (savedName) usernameDisplay.textContent = savedName;
    if (savedPhoto) backgroundBlur.src = savedPhoto;

    // ✅ Afficher le formulaire
    editBtn.addEventListener("click", () => {
      form.classList.toggle("hidden");
      nameInput.value = usernameDisplay.textContent;
    });

    // ✅ Prévisualisation de l’image dès sélection
    photoInput.addEventListener("change", () => {
      const file = photoInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          previewImg.src = reader.result;
          previewImg.classList.remove("hidden");
          previewImg.classList.add("visible");
        };
        reader.readAsDataURL(file);
      }
    });

    // ✅ Sauvegarder les modifications
    saveBtn.addEventListener("click", () => {
      const newName = nameInput.value.trim();
      if (newName) {
        usernameDisplay.textContent = newName;
        localStorage.setItem("profileName", newName);
      }

      const file = photoInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          backgroundBlur.src = reader.result;
          localStorage.setItem("profilePhoto", reader.result);
          previewImg.classList.add("hidden");
          previewImg.classList.remove("visible");
        };
        reader.readAsDataURL(file);
      }

      form.classList.add("hidden");
    });
  });
</script>
</body>
</html>
