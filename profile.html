<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="profile.css" />
  <title>Profile</title>
</head>
<body>
  <div class="profile-wrapper">
    <div class="profile-card">
      <img class="background-blur" src="vangogh.png" alt="Fond artistique" />
      <img class="background-preview hidden" alt="Prévisualisation" />

      <div class="section-title badges-title">Badges</div>
      <div class="section-line badges-line"></div>

      <div class="badges-grid">
        <img src="badge/Van Gogh.png" alt="Van Gogh" />
        <img src="badge/Picasso.png" alt="Picasso" />
        <img src="badge/Kahlo.png" alt="Kahlo" />
        <img src="badge/Monnet.png" alt="Monnet" />
        <img src="badge/Vinci.png" alt="Vinci" />
        <img src="badge/Dali.png" alt="Dali" />
      </div>

      <div class="stat-box red">
        <img src="likee.png" alt="Likes" />
        <div>1500</div>
      </div>

      <div class="stat-box yellow">
        <img src="fav2E.png" alt="Favoris" />
        <div>1500</div>
      </div>

      <div class="section-title stats-title">Statistiques</div>
      <div class="section-line stats-line"></div>

      <div class="level">Niv. 1</div>
      <div class="username">Yanaab</div>

      <div class="progress-bar-bg"></div>
      <div class="progress-bar-fill"></div>
      <div class="xp-text">150/200</div>

      <!-- Carte de visite -->
      <div class="section-title card-title">Carte de visite</div>
      <div class="section-line card-line"></div>
      <div class="business-card">
        <img src="card/SN.png" alt="Carte de visite" class="card-image" />
      </div>

      <!-- Bouton ouvrir inventaire -->
      <img src="pen.png" alt="Ouvrir inventaire" class="inventory-btn" />
    </div>

    <div class="edit-button-wrapper">
      <img src="edit.png" alt="Éditer le profil" class="edit-profile-button" />
    </div>

    <div class="edit-profile-form hidden">
      <label for="nameInput">Nom :</label>
      <input type="text" id="nameInput" placeholder="Entrez votre nom" />

      <label for="photoInput" class="custom-file-upload">
        <img src="profile.png" alt="Choisir une image" />
      </label>
      <input type="file" id="photoInput" accept="image/*" />

      <button id="saveProfileBtn">
        Sauvegarder
        <div class="star-1">…</div>
        <div class="star-2">…</div>
        <div class="star-3">…</div>
        <div class="star-4">…</div>
        <div class="star-5">…</div>
        <div class="star-6">…</div>
      </button>
    </div>

    <!-- Overlay Inventaire -->
    <div id="inventoryOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.8); z-index:1000; overflow:auto;">
      <div style="position:relative; margin:5% auto; padding:2vw; width:80%; max-width:800px; background-color:#111; border-radius:1vw; text-align:center; color:white;">
        <span id="closeInventory" style="position:absolute; top:1vw; right:1.5vw; font-size:2vw; cursor:pointer;">&times;</span>
        <h2>Inventaire</h2>
        <div id="inventoryOverlayContainer" style="display:flex; flex-wrap:wrap; justify-content:center; gap:1vw; margin-top:2vw;">
          <!-- Cartes dynamiques ici -->
        </div>
      </div>
    </div>

    <img class="logo" src="Logo.png" alt="Logo" />
    <div class="page-title">Profile</div>
  </div>

  <div class="navbar">
    <a href="trends.html"><img class="icon" src="home.png" alt="Profil" /></a>
    <a href="peinture.html"><img class="icon" src="peinture.png" alt="Peinture" /></a>
    <a href="#"><img class="icon" src="peintre.png" alt="Peintre" /></a>
    <a href="#"><img class="icon" src="museum.png" alt="Musée" /></a>
    <a href="collection.html"><img class="icon" src="fav.png" alt="Favoris" /></a>
    <a href="profile.html" class="home-link">
      <div class="home-marker"></div>
      <img class="icon home-icon" src="profile.png" alt="Accueil" />
    </a>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const editBtn = document.querySelector(".edit-profile-button");
  const form = document.querySelector(".edit-profile-form");
  const nameInput = document.getElementById("nameInput");
  const photoInput = document.getElementById("photoInput");
  const saveBtn = document.getElementById("saveProfileBtn");
  const usernameDisplay = document.querySelector(".username");
  const backgroundBlur = document.querySelector(".background-blur");
  const previewImg = document.querySelector(".background-preview");

  const inventoryBtn = document.querySelector(".inventory-btn");
  const inventoryOverlay = document.getElementById("inventoryOverlay");
  const overlayInventoryContainer = document.getElementById("inventoryOverlayContainer");
  const closeInventoryBtn = document.getElementById("closeInventory");
  const businessCardImg = document.querySelector(".card-image");

  // Gestion inventaire
  function getInventory() {
    return JSON.parse(localStorage.getItem('userInventory') || '[]');
  }

  function saveInventory(inventory) {
    localStorage.setItem('userInventory', JSON.stringify(inventory));
  }

  // Gestion carte de visite
  function getBusinessCard() {
    return localStorage.getItem('businessCard') || null;
  }

  function setBusinessCard(cardName) {
    localStorage.setItem('businessCard', cardName);
    updateBusinessCard();
  }

  function removeBusinessCard() {
    localStorage.removeItem('businessCard');
    updateBusinessCard();
  }

  function updateBusinessCard() {
    const currentCard = getBusinessCard();
    if(currentCard) {
      businessCardImg.src = `card/${currentCard}.png`;
      businessCardImg.alt = currentCard;
    } else {
      businessCardImg.src = '';
      businessCardImg.alt = "Aucune carte équipée";
    }
  }

  // Création d’une image cliquable pour l’inventaire
  function createCardImage(card) {
    const img = document.createElement('img');
    img.src = `card/${card}.png`;
    img.alt = card;
    img.style.width = '150px';
    img.style.borderRadius = '10px';
    img.style.cursor = 'pointer';
    img.style.transition = 'transform 0.3s ease, box-shadow 0.3s ease';
    img.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';

    const currentCard = getBusinessCard();
    if(currentCard === card){
      img.style.border = '3px solid gold';
      img.style.boxShadow = '0 0 15px rgba(255,215,0,0.6)';
    }

    img.addEventListener('mouseenter', ()=>img.style.transform='scale(1.05)');
    img.addEventListener('mouseleave', ()=>img.style.transform='scale(1)');

    img.addEventListener('click', () => {
      const current = getBusinessCard();
      if(current === card){
        removeBusinessCard();
      } else {
        setBusinessCard(card);
      }
      displayInventory();
    });

    img.onerror = ()=>{img.style.display="none";};

    return img;
  }

  function displayInventory() {
    overlayInventoryContainer.innerHTML = '';
    const inventory = getInventory();

    if(inventory.length===0){
      overlayInventoryContainer.innerHTML='<p style="color:white;">Aucune carte dans votre inventaire.</p>';
      return;
    }

    inventory.forEach(card => overlayInventoryContainer.appendChild(createCardImage(card)));
  }

  // Initialisation
  updateBusinessCard();
  displayInventory();

  // Formulaire édition
  editBtn.addEventListener("click", ()=>{
    form.classList.remove("hidden");
    nameInput.value = usernameDisplay.textContent;
  });

  const savedName = localStorage.getItem("profileName");
  const savedPhoto = localStorage.getItem("profilePhoto");
  usernameDisplay.textContent = savedName || "Invité";
  if(savedPhoto) backgroundBlur.src = savedPhoto;

  photoInput.addEventListener("change", ()=>{
    const file = photoInput.files[0];
    if(file && file.type.startsWith("image/")){
      const reader = new FileReader();
      reader.onload=()=>{previewImg.src=reader.result; previewImg.classList.remove("hidden");};
      reader.readAsDataURL(file);
    }
  });

  saveBtn.addEventListener("click", ()=>{
    const newName = nameInput.value.trim();
    if(newName){usernameDisplay.textContent=newName; localStorage.setItem("profileName", newName);}
    if(previewImg.src && !previewImg.classList.contains('hidden')){
      backgroundBlur.src = previewImg.src;
      localStorage.setItem("profilePhoto", previewImg.src);
      previewImg.classList.add("hidden");
    }
    form.classList.add("hidden");
  });

  // Overlay inventaire
  inventoryBtn.addEventListener("click", ()=>{
    inventoryOverlay.style.display="block";
    displayInventory();
  });

  closeInventoryBtn.addEventListener("click", ()=>inventoryOverlay.style.display="none");
  document.addEventListener('keydown', (e)=>{if(e.key==='Escape' && inventoryOverlay.style.display==='block'){inventoryOverlay.style.display='none';}});

  // Ajouter carte par défaut si inventaire vide
  if(getInventory().length===0){
    saveInventory(['SN']);
    displayInventory();
  }
});
</script>








</body>
</html>